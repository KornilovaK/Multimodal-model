# Multimodal-model
Проект заключается в обучении мультимодальной модели для задачи мэтчинга товаров. Карточки с маркетплейса Ozon представляют собой набор изоражений, текстовых описаний и различных табличных характеристик. 

## Data
Скачайте датасет. Ссылка: https://storage.yandexcloud.net/contestfiles/A_E_CUP/competition.zip
Поместите файлы .parquet поместите в папку data/raw. Он включаест в себя .parquet файлы: train(пара id и таргет: 0/1), test(пара id), attributes(id и categories), text_and_bert(id, названия товаров и их готовые эмбеддинги, полученные с помощью bert, описания товаров), resnet(id, 1 основное фото, от 0 до 16 дополнительных фото). 

## План:
### Обработка и анализ данных
Из тренировочных данных исключить тестовые, просмотреть пропуски значений. Тк данных много, если ваши мощности не позволяют, можно уменьшить объем данных, но качество соответственно будет хуже.

### Процессинг разных модальностей: attributes, texts, images
Есть 2 подхода к обработке данных: 1. Можно сделать представления всех модальностей в виде эмбеддингов и работать чисто с векторами, либо работать уже только с различными расстояниями между ними
* Аттрибуты представляют собой словари в строковом виде. Разных и редких категорий очень много, поэтому нет смысла парсить словари и доставать категории -> используем мультиязычный SentenseTransformer, чтобы получить эмбеддинги, чувствительные к знакам препинания, участвующим в формировании словарей
* Использовать готовые эмбеддинги названий, а descriptions нужно очистить, обработать и заэнкодить с помощью rubert-tiny 2
* Для дополнительных фото используем PCA, чтобы понизить размерность с количество фотографий на 1

### Соединение в единый датасет
Используем inner join по train id

### Выбор модели и структуры обучающих данных
Целевая метрика - PR-AUC
* Первый вариант - использование классических подходов мл. Например, хорошим вариантом является Tabular LightAutoMl. Для него рассчитаем distances между соответствующими эмбеддингами для каждой пары. Pr-auc = 0.85
* Второй - обучение нейронных сетей: Siamese Neural network с constastive loss Pr-auc = 0.79 или custom архитекруту для бинарной классификации c CrossEntropy loss. Pr-auc = 0.87